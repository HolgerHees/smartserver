# Default rules
domain (ip ip6) {
    table filter {
        # Default Policies
        chain INPUT policy DROP;
        chain OUTPUT policy ACCEPT;

        # loopback traffic
        chain INPUT interface lo ACCEPT;
        chain OUTPUT outerface lo ACCEPT;

        chain (INPUT OUTPUT) {
            # connection tracking
            mod conntrack ctstate (RELATED ESTABLISHED) ACCEPT;

            # ICMP is very handy and necessary
            proto icmp ACCEPT;
            proto ipv6-icmp ACCEPT;

            # DHCPv6 Client listener
            # proto udp saddr fe80::/10 sport 547 daddr fe80::/10 dport 546 ACCEPT;
            # MULTICAST mDNS
            # proto udp daddr ff02::fb dport 5353 ACCEPT;
            # MULTICAST UPnP
            # proto udp daddr ff02::fb dport 1900 ACCEPT;
        }
    }
}

# Local rules
@include ferm.d/; 
