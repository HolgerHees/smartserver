# Default rules
domain (ip ip6) {
    table filter {
        # Default Policies
        chain INPUT policy DROP;
        chain OUTPUT policy ACCEPT;

        # loopback traffic
        chain INPUT interface lo ACCEPT;
        chain OUTPUT outerface lo ACCEPT;

        chain (INPUT OUTPUT) {
            # connection tracking
            mod conntrack ctstate (RELATED ESTABLISHED) ACCEPT;

            # ICMP is very handy and necessary, but container ip's are not allowed to connect to host
            #proto icmp saddr !172.0.0.0/8 ACCEPT; # => not necessary, because internal network already ACCEPT 'all' in 'trusted' rule
        }
    }
}

# Local rules
@include ferm.d/; 
