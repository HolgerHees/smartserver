listener 1883 0.0.0.0
listener 9001 0.0.0.0

log_dest stdout
log_type error
log_type warning
log_type notice
log_type information
log_type subscribe
log_type unsubscribe

allow_anonymous true

{% if cloud_vpn.interface.address != "{{vpn_cloud_subnet}}.0.1" %}
{% for peer_name in cloud_vpn.peers %}
{% if cloud_vpn.peers[peer_name].network.split('.')[:3] == "{{vpn_cloud_subnet}}.0" %}
connection {{peer_name}}
address {{vpn_cloud_subnet}}.1.4
topic {{peer_name}}# in
{% endif %}
{% endfor %}
{% endif %}

#{% for peer_name in cloud_vpn.peers %}
#connection {{peer_name}}
#cleansession true
#address {{vpn_cloud_services.remote[peer_name].mosquitto}}
#topic {{peer_name}}/# in
#{% endfor %}

