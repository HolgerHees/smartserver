- name: read service facts
  service_facts:

- name: check if apache2 is running
  systemd:
    name: apache2
    state: started
    daemon_reload: yes
  changed_when: "ansible_facts.services|selectattr('apache2.service',{})|selectattr('state') != 'running'"
