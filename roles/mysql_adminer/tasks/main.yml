- name: set adminer version
  set_fact:
    adminer_version: '4.7.5'
    
- name: check installation
  stat:
    path: "{{htdocs_path}}mysql-adminer-{{adminer_version}}"
  register: adminer_exists
  changed_when: not adminer_exists.stat.exists
  
- name: install archive
  unarchive:
    src: "https://github.com/vrana/adminer/releases/download/v4.7.5/adminer-{{adminer_version}}.zip"
    dest: "{{htdocs_path}}"
    remote_src: yes
    owner: wwwrun
    group: www
    #mode: 0750
  when: not adminer_exists.stat.exists

- name: rename folder
  command: "mv {{htdocs_path}}adminer-{{adminer_version}}/ {{htdocs_path}}mysql-adminer-{{adminer_version}}"
  when: not adminer_exists.stat.exists
  
- name: set symbolic link
  file:
    src: "mysql-adminer-{{adminer_version}}"
    dest: "{{htdocs_path}}mysql-adminer"
    state: link
    owner: wwwrun
    group: www
  when: not adminer_exists.stat.exists
  
#- name: prepare config folder
#  file:
#    path: "{{htdocs_path}}mysql-adminer/config"
#    state: directory
#    owner: wwwrun
#    group: www
#    mode: 0770

#- name: copy config
#  template:
#    src: "roles/mysql_phpmyadmin/templates/config.inc.php"
#    dest: "{{htdocs_path}}mysql-adminer/config.inc.php"
#    owner: wwwrun
#    group: www
#    mode: 0640
    
