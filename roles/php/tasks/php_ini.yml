- name: set php config
  lineinfile:
    path: "{{php_ini_file}}"
    insertafter: '^\[{{item.block}}\]'
    regexp: '^[#]*{{item.field}}\s*='
    line: '{{item.field}}={{item.value}}'
  with_items:
    - { block: 'PHP', field: 'memory_limit', value: '1024M' }
    - { block: 'opcache', field: 'opcache.enable', value: '1' }
    - { block: 'opcache', field: 'opcache.enable_cli', value: '1' }
    - { block: 'opcache', field: 'opcache.interned_strings_buffer', value: '8' }
    - { block: 'opcache', field: 'opcache.max_accelerated_files', value: '10000' }
    - { block: 'opcache', field: 'opcache.memory_consumption', value: '128' }
    - { block: 'opcache', field: 'opcache.save_comments', value: '1' }
    - { block: 'opcache', field: 'opcache.revalidate_freq', value: '1' }
