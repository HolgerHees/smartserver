- name: copy config
  template:
    src: "templates/etc/apache2/_.ansible.d/proxy.conf"
    dest: "{{www_etc}}_.ansible.d/proxy.conf"
    owner: root
    group: root
    mode: 0644
  notify: "restart apache"

- name: prepare needed folder
  file:
    path: "{{item.dir}}"
    state: directory
    owner: "{{item.owner}}"
    group: "{{item.group}}"
    mode: 0755
  with_items:
    - { owner: "{{www_username}}", group: "{{www_group}}", dir: "{{htdocs_path}}fallback/" }
    - { owner: "{{www_username}}", group: "{{www_group}}", dir: "{{htdocs_path}}fallback/tmpfs/" }

- name: copy balancer fallback files
  copy:
    src: "templates/device404.jpg"
    dest: "{{htdocs_path}}fallback/{{item}}"
    owner: "{{www_username}}"
    group: "{{www_group}}"
  with_items:
    - cam.jpg # automower
    - cam.mjpg # automower
    - snapshot.cgi # automower
    - videostream.cgi # automower
    - tmpfs/snap.jpg # camera strasse
    - mjpegstream.cgi # camera strasse

